<!doctype html><html lang=es class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link rel="shortcut icon" href=../images/favicon.png><meta name=generator content="mkdocs-1.2.3, mkdocs-material-5.4.0"><title>Instalación - Documentación de Usuario.</title><link rel=stylesheet href=../assets/stylesheets/main.fe0cca5b.min.css><link rel=stylesheet href=../assets/stylesheets/palette.a46bcfb3.min.css><link href=https://fonts.gstatic.com rel=preconnect crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback"><style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style><link rel=stylesheet href=../stylesheets/extra.css></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary data-md-color-accent=light-blue> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#instalacion-del-sistema class=md-skip> Saltar a contenido </a> </div> <div data-md-component=announce> </div> <header class=md-header data-md-component=header> <nav class="md-header-nav md-grid" aria-label=Cabecera> <a href=.. title="Documentación de Usuario." class="md-header-nav__button md-logo" aria-label="Documentación de Usuario."> <img src=../images/logo.png alt=logo> </a> <label class="md-header-nav__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg> </label> <div class=md-header-nav__title data-md-component=header-title> <div class=md-header-nav__ellipsis> <span class="md-header-nav__topic md-ellipsis"> Documentación de Usuario. </span> <span class="md-header-nav__topic md-ellipsis"> Instalación </span> </div> </div> <label class="md-header-nav__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Búsqueda placeholder=Búsqueda autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query data-md-state=active> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </label> <button type=reset class="md-search__icon md-icon" aria-label=Limpiar data-md-component=search-reset tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg> </button> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> <div class=md-header-nav__source> <a href=https://gestion.cenditel.gob.ve/trac/browser/kavac/ title="Ir al repositorio" class=md-source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><path d="M100.59 334.24c48.57 3.31 58.95 2.11 58.95 11.94 0 20-65.55 20.06-65.55 1.52.01-5.09 3.29-9.4 6.6-13.46zm27.95-116.64c-32.29 0-33.75 44.47-.75 44.47 32.51 0 31.71-44.47.75-44.47zM448 80v352a48 48 0 01-48 48H48a48 48 0 01-48-48V80a48 48 0 0148-48h352a48 48 0 0148 48zm-227 69.31c0 14.49 8.38 22.88 22.86 22.88 14.74 0 23.13-8.39 23.13-22.88S258.62 127 243.88 127c-14.48 0-22.88 7.84-22.88 22.31zM199.18 195h-49.55c-25-6.55-81.56-4.85-81.56 46.75 0 18.8 9.4 32 21.85 38.11C74.23 294.23 66.8 301 66.8 310.6c0 6.87 2.79 13.22 11.18 16.76-8.9 8.4-14 14.48-14 25.92C64 373.35 81.53 385 127.52 385c44.22 0 69.87-16.51 69.87-45.73 0-36.67-28.23-35.32-94.77-39.38l8.38-13.43c17 4.74 74.19 6.23 74.19-42.43 0-11.69-4.83-19.82-9.4-25.67l23.38-1.78zm84.34 109.84l-13-1.78c-3.82-.51-4.07-1-4.07-5.09V192.52h-52.6l-2.79 20.57c15.75 5.55 17 4.86 17 10.17V298c0 5.62-.31 4.58-17 6.87v20.06h72.42zM384 315l-6.87-22.37c-40.93 15.37-37.85-12.41-37.85-16.73v-60.72h37.85v-25.41h-35.82c-2.87 0-2 2.52-2-38.63h-24.18c-2.79 27.7-11.68 38.88-34 41.42v22.62c20.47 0 19.82-.85 19.82 2.54v66.57c0 28.72 11.43 40.91 41.67 40.91 14.45 0 30.45-4.83 41.38-10.2z"/></svg> </div> <div class=md-source__repository> Repositorio-Kavac </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" aria-label=Navegación data-md-level=0> <label class=md-nav__title for=__drawer> <a href=.. title="Documentación de Usuario." class="md-nav__button md-logo" aria-label="Documentación de Usuario."> <img src=../images/logo.png alt=logo> </a> Documentación de Usuario. </label> <div class=md-nav__source> <a href=https://gestion.cenditel.gob.ve/trac/browser/kavac/ title="Ir al repositorio" class=md-source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><path d="M100.59 334.24c48.57 3.31 58.95 2.11 58.95 11.94 0 20-65.55 20.06-65.55 1.52.01-5.09 3.29-9.4 6.6-13.46zm27.95-116.64c-32.29 0-33.75 44.47-.75 44.47 32.51 0 31.71-44.47.75-44.47zM448 80v352a48 48 0 01-48 48H48a48 48 0 01-48-48V80a48 48 0 0148-48h352a48 48 0 0148 48zm-227 69.31c0 14.49 8.38 22.88 22.86 22.88 14.74 0 23.13-8.39 23.13-22.88S258.62 127 243.88 127c-14.48 0-22.88 7.84-22.88 22.31zM199.18 195h-49.55c-25-6.55-81.56-4.85-81.56 46.75 0 18.8 9.4 32 21.85 38.11C74.23 294.23 66.8 301 66.8 310.6c0 6.87 2.79 13.22 11.18 16.76-8.9 8.4-14 14.48-14 25.92C64 373.35 81.53 385 127.52 385c44.22 0 69.87-16.51 69.87-45.73 0-36.67-28.23-35.32-94.77-39.38l8.38-13.43c17 4.74 74.19 6.23 74.19-42.43 0-11.69-4.83-19.82-9.4-25.67l23.38-1.78zm84.34 109.84l-13-1.78c-3.82-.51-4.07-1-4.07-5.09V192.52h-52.6l-2.79 20.57c15.75 5.55 17 4.86 17 10.17V298c0 5.62-.31 4.58-17 6.87v20.06h72.42zM384 315l-6.87-22.37c-40.93 15.37-37.85-12.41-37.85-16.73v-60.72h37.85v-25.41h-35.82c-2.87 0-2 2.52-2-38.63h-24.18c-2.79 27.7-11.68 38.88-34 41.42v22.62c20.47 0 19.82-.85 19.82 2.54v66.57c0 28.72 11.43 40.91 41.67 40.91 14.45 0 30.45-4.83 41.38-10.2z"/></svg> </div> <div class=md-source__repository> Repositorio-Kavac </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=.. title=Inicio class=md-nav__link> Inicio </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-2 type=checkbox id=nav-2 checked> <label class=md-nav__link for=nav-2> Sistema KAVAC <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg> </span> </label> <nav class=md-nav aria-label="Sistema KAVAC" data-md-level=1> <label class=md-nav__title for=nav-2> <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </span> Sistema KAVAC </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../about/ title="Acerca de" class=md-nav__link> Acerca de </a> </li> <li class=md-nav__item> <a href=../development_methodology/ title="Gestión de Proyecto" class=md-nav__link> Gestión de Proyecto </a> </li> <li class=md-nav__item> <a href=../information/ title="Información General" class=md-nav__link> Información General </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" data-md-toggle=toc type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> Instalación <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 9h14V7H3v2m0 4h14v-2H3v2m0 4h14v-2H3v2m16 0h2v-2h-2v2m0-10v2h2V7h-2m0 6h2v-2h-2v2z"/></svg> </span> </label> <a href=./ title=Instalación class="md-nav__link md-nav__link--active"> Instalación </a> <nav class="md-nav md-nav--secondary" aria-label="Tabla de contenidos"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </span> Tabla de contenidos </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=#prerrequisitos class=md-nav__link> Prerrequisitos </a> </li> <li class=md-nav__item> <a href=#glosario class=md-nav__link> Glosario </a> </li> <li class=md-nav__item> <a href=#configuracion-del-servidor-de-aplicaciones class=md-nav__link> Configuración del Servidor de Aplicaciones </a> </li> <li class=md-nav__item> <a href=#instalar-nginx class=md-nav__link> Instalar Nginx </a> </li> <li class=md-nav__item> <a href=#instalar-php-fpm class=md-nav__link> Instalar PHP-FPM </a> </li> <li class=md-nav__item> <a href=#configurar-el-servidor-virtual-de-nginx class=md-nav__link> Configurar el servidor virtual de Nginx </a> </li> <li class=md-nav__item> <a href=#instalacion class=md-nav__link> Instalación </a> </li> <li class=md-nav__item> <a href=#base-de-datos class=md-nav__link> Base de datos </a> </li> <li class=md-nav__item> <a href=#procesamiento-de-colas class=md-nav__link> Procesamiento de colas </a> </li> <li class=md-nav__item> <a href=#websockets class=md-nav__link> Websockets </a> </li> <li class=md-nav__item> <a href=#registros-iniciales class=md-nav__link> Registros iniciales </a> </li> <li class=md-nav__item> <a href=#probando-la-aplicacion class=md-nav__link> Probando la aplicación </a> </li> <li class=md-nav__item> <a href=#comandos-basicos-laravel-modules class=md-nav__link> Comandos básicos laravel-modules </a> </li> <li class=md-nav__item> <a href=#laravel-er-diagram-generator class=md-nav__link> Laravel ER Diagram Generator </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-3 type=checkbox id=nav-3> <label class=md-nav__link for=nav-3> Configuración <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg> </span> </label> <nav class=md-nav aria-label=Configuración data-md-level=1> <label class=md-nav__title for=nav-3> <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </span> Configuración </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../setting/setting/ title=Configuración class=md-nav__link> Configuración </a> </li> <li class=md-nav__item> <a href=../setting/general_setting/ title="Configuración General" class=md-nav__link> Configuración General </a> </li> <li class=md-nav__item> <a href=../setting/access_setting/ title="Configuración de Acceso" class=md-nav__link> Configuración de Acceso </a> </li> <li class=md-nav__item> <a href=../setting/modules_setting/ title="Configuración de Módulos" class=md-nav__link> Configuración de Módulos </a> </li> <li class=md-nav__item> <a href=../setting/user_account_setting/ title="Configuración de Cuenta de Usuario" class=md-nav__link> Configuración de Cuenta de Usuario </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-4 type=checkbox id=nav-4> <label class=md-nav__link for=nav-4> Panel de Control <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg> </span> </label> <nav class=md-nav aria-label="Panel de Control" data-md-level=1> <label class=md-nav__title for=nav-4> <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </span> Panel de Control </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../control_panel/control_panel/ title="Panel de Control" class=md-nav__link> Panel de Control </a> </li> <li class=md-nav__item> <a href=../control_panel/developers/ title="Herramientas para Desarrolladores" class=md-nav__link> Herramientas para Desarrolladores </a> </li> <li class=md-nav__item> <a href=../control_panel/access_control/ title="Control de Acceso" class=md-nav__link> Control de Acceso </a> </li> <li class=md-nav__item> <a href=../control_panel/accounting_module/ title="Módulo de Contabilidad" class=md-nav__link> Módulo de Contabilidad </a> </li> <li class=md-nav__item> <a href=../control_panel/asset_module/ title="Módulo de Bienes" class=md-nav__link> Módulo de Bienes </a> </li> <li class=md-nav__item> <a href=../control_panel/warehouse_module/ title="Módulo de Almacén" class=md-nav__link> Módulo de Almacén </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../frequent_questions/ title="Preguntas Frecuentes" class=md-nav__link> Preguntas Frecuentes </a> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Tabla de contenidos"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </span> Tabla de contenidos </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=#prerrequisitos class=md-nav__link> Prerrequisitos </a> </li> <li class=md-nav__item> <a href=#glosario class=md-nav__link> Glosario </a> </li> <li class=md-nav__item> <a href=#configuracion-del-servidor-de-aplicaciones class=md-nav__link> Configuración del Servidor de Aplicaciones </a> </li> <li class=md-nav__item> <a href=#instalar-nginx class=md-nav__link> Instalar Nginx </a> </li> <li class=md-nav__item> <a href=#instalar-php-fpm class=md-nav__link> Instalar PHP-FPM </a> </li> <li class=md-nav__item> <a href=#configurar-el-servidor-virtual-de-nginx class=md-nav__link> Configurar el servidor virtual de Nginx </a> </li> <li class=md-nav__item> <a href=#instalacion class=md-nav__link> Instalación </a> </li> <li class=md-nav__item> <a href=#base-de-datos class=md-nav__link> Base de datos </a> </li> <li class=md-nav__item> <a href=#procesamiento-de-colas class=md-nav__link> Procesamiento de colas </a> </li> <li class=md-nav__item> <a href=#websockets class=md-nav__link> Websockets </a> </li> <li class=md-nav__item> <a href=#registros-iniciales class=md-nav__link> Registros iniciales </a> </li> <li class=md-nav__item> <a href=#probando-la-aplicacion class=md-nav__link> Probando la aplicación </a> </li> <li class=md-nav__item> <a href=#comandos-basicos-laravel-modules class=md-nav__link> Comandos básicos laravel-modules </a> </li> <li class=md-nav__item> <a href=#laravel-er-diagram-generator class=md-nav__link> Laravel ER Diagram Generator </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content> <article class="md-content__inner md-typeset"> <h1 id=instalacion-del-sistema>Instalación del Sistema</h1> <hr> <h2 id=prerrequisitos>Prerrequisitos</h2> <p>A continuación se listan los paquetes previos requeridos para la instalación y correcto funcionamiento de la aplicación:</p> <pre><code>php &gt;= 7.4.x.
php-gd.
php-mbstring.
php-tokenizer.
php-zip.
php-pgsql.
php-cli.
php-curl.
composer.
zip.
unzip.
nodejs.
postgresql.
Servidor de aplicaciones nginx, apache, etc.
</code></pre> <h2 id=glosario>Glosario</h2> <p><strong>(ruta-absoluta-de-instalacion)</strong>: Es la ruta en donde se va a instalar la aplicación, colocando la misma sin los (), por ejemplo:</p> <pre><code> /srv/kavac/
</code></pre> <p><strong>(version-php-instalada)</strong>: Es la versión del o los paquetes de PHP instalados, colocando la misma sin los (), por ejemplo:</p> <pre><code>7.4
</code></pre> <h2 id=configuracion-del-servidor-de-aplicaciones>Configuración del Servidor de Aplicaciones</h2> <p>En esta documentación se explica cómo configurar un servidor de aplicaciones Nginx (para otro tipo de servidor se debe consultar la documentación pertinente para una configuración óptima en aplicaciones basadas en PHP).</p> <h2 id=instalar-nginx>Instalar Nginx</h2> <p>Lo primero que se debe realizar es la instalación del servidor de aplicaciones con el comando:</p> <pre><code> apt install nginx
</code></pre> <p>Una vez completada la instalación, inicie el servicio Nginx y agréguelo para que se inicie automáticamente con el sistema operativo mediante el comando systemctl:</p> <pre><code> systemctl start nginx

 systemctl enable nginx
</code></pre> <p>El servidor Nginx se ejecutará en el puerto 80, para verificar si se ejecutó correctamente debe ejecutar el comando:</p> <pre><code> netstat -plntu
</code></pre> <p>Si todo lo muestra correctamente, Nginx estará instalado y en ejecución.</p> <h2 id=instalar-php-fpm>Instalar PHP-FPM</h2> <p>Para instalar la extensión FPM (FastCGI Process Manager) de la versión de PHP instalada en el sistema operativo se debe ejecutar el comando:</p> <pre><code> apt install php-fpm
</code></pre> <p>El próximo paso es configurar el archivo php.ini de FPM, para lo cual se debe acceder a la ruta en donde fue instalado, por lo general esta ruta se encuentra en /etc/php/(version-php-instalada)/, para esto se debe editar ejecutando:</p> <pre><code> nano/etc/php/(version-php-instalada)/php.ini ,
</code></pre> <p>Donde <strong>(version-php-instalada)</strong> es la versión de php instalada en el servidor.</p> <p>En el contenido del archivo se debe buscar y descomentar la variable <strong>cgi.fix_pathinfo=1</strong> y cambiar el valor a 0.</p> <pre><code> cgi.fix_pathinfo=0
</code></pre> <p>Guardar las modificaciones realizadas e inicializar el servicio FPM con los comandos:</p> <pre><code> systemctl start php(version-php-instalada)-fpm
 systemctl enable php(version-php-instalada)-fpm
</code></pre> <p>El primer comando inicializa el servicio y el segundo lo habilita para que se ejecute automáticamente al arrancar el servidor.</p> <p>Por defecto en sistemas operativos como Ubuntu el servicio PHP-FPM se ejecuta bajo un archivo socket, para verificar que el servicio PHP-FPM se haya inicializado correctamente deberá escribir el comando netstat de la siguiente forma:</p> <pre><code> netstat -pl | grep php(version-php-instalada)-fpm
</code></pre> <p>Con lo anterior, el servidor virtual para la aplicación fue creado, sólo queda reiniciar el servidor Nginx para que las modificaciones tengan efecto, para esto se debe ejecutar:</p> <pre><code> systemctl restart nginx
</code></pre> <h2 id=configurar-el-servidor-virtual-de-nginx>Configurar el servidor virtual de Nginx</h2> <p>Para que la aplicación se ejecute en el servidor de aplicaciones Nginx, se debe realizar una configuración adicional, creando un archivo que contendrá dicha configuración, para esto se ejecutará el siguiente comando:</p> <pre><code> nano /etc/nginx/sites-available/kavac

  Se agregará el siguiente contenido:

        server {

            listen 80;
            Descomentar si las peticiones solo aceptan el protocolo ipv6
            listen [::]:80 ipv6only=on;

            Log files for Debugging
            access_log /var/log/nginx/kavac-access.log;
            error_log /var/log/nginx/kavac-error.log;

            Webroot Directory for kavac project
            root (ruta-absoluta-de-instalacion)/public;
            index index.php index.html index.htm;

            Your Domain Name
            server_name (nombre-de-dominio-que-atiende-las-peticiones);

            location / {
            try_files $uri $uri/ /index.php?$query_string;
            }

            PHP-FPM Configuration Nginx
            location ~ \.php$ {
                    try_files $uri =404;
                    fastcgi_split_path_info ^(.+\.php)(/.+)$;
                    fastcgi_pass unix:/run/php/php(version-php-instalada)-fpm.sock;
                    fastcgi_index index.php;
                    fastcgi_param SCRIPT_FILENAME $document_root$fastcgi _script_name;
                    include fastcgi_params;
            }
        }
</code></pre> <p>Guarda las modificaciones y cierra el archivo.</p> <p>Ahora para activar el servidor virtual se debe crear un enlace simbólico al archivo de configuración de la siguiente forma:</p> <pre><code> ln -s /etc/nginx/sites-available/kavac /etc/nginx/sites-enabled/
</code></pre> <p>Para que estos cambios tengan efecto se debe reiniciar el servidor de aplicaciones:</p> <pre><code> systemctl restart
</code></pre> <h2 id=instalacion>Instalación</h2> <p>Para poder ejecutar la instalación es importante contar con el paquete <a href=https://getcomposer.org/ >composer</a> el cual permite gestionar las distintas dependencias y/o paquetes requeridos por el sistema y una conexión externa a Internet. Cabe destacar que para mejores resultados, se debe tener instalado composer de manera global.</p> <p>Por otro lado, se requiere contar con el paquete NodeJS para gestionar los paquetes requeridos para la reactividad en la gestión de datos de algunos procesos, para lo cual se requiere seguir la documentación de <a href=https://nodejs.org/ >nodejs</a> para el sistema operativo en el que se vaya a ejecutar la aplicación.</p> <p>Abrir un terminal y posicionarse en la ruta base del proyecto "/", luego ejecuta la siguiente instrucción:</p> <pre><code> composer install
</code></pre> <p>Una vez instalada la aplicación, ejecuta el comando:</p> <pre><code> php artisan key:generate
</code></pre> <p>Esto generará un identificador único para la aplicación y creará (si no existe), el archivo de configuración .env, en caso de que no se genere dicho archivo, se debe ejecutar el comando:</p> <pre><code> cp .env.example .env
</code></pre> <p>Luego se debe repetir el paso anterior.</p> <p>Para un mejor rendimiento de la aplicación en entornos de producción se recomienda utilizar el comando:</p> <pre><code> composer install --optimize-autoloader --no-dev
</code></pre> <p>Esto permitirá una carga más optimizada de los componentes del sistema.</p> <p>En el archivo .env, localizado en la raíz del sistema, se deben establecer los parámetros de configuración necesarios bajo los cuales se ejecutará la aplicación.</p> <pre><code>  APP_NAME
  APP_ENV
  APP_KEY
  APP_DEBUG
  APP_LOG_LEVEL
  APP_URL

  DB_CONNECTION
  DB_HOST
  DB_PORT
  DB_DATABASE
  DB_USERNAME
  DB_PASSWORD

  BROADCAST_DRIVER
  CACHE_DRIVER
  SESSION_DRIVER
  QUEUE_DRIVER

  REDIS_HOST
  REDIS_PASSWORD
  REDIS_PORT

  MAIL_DRIVER
  MAIL_HOST
  MAIL_PORT
  MAIL_USERNAME
  MAIL_PASSWORD
  MAIL_ENCRYPTION

  PUSHER_APP_ID
  PUSHER_APP_KEY
  PUSHER_APP_SECRET
  PUSHER_APP_CLUSTER
</code></pre> <p>De igual manera se debe instalar los paquetes necesarios para la gestión reactiva de datos, para lo cual se debe ejecutar el siguiente comando (teniendo en cuenta que se debe contar con nodejs y npm previamente instalados):</p> <pre><code> npm install
</code></pre> <p>El comando anterior instala todas las dependencias de node requeridas por el sistema.</p> <p>El último paso en el proceso de instalación es modificar los usuarios y permisos para el acceso del servidor a la aplicación KAVAC, para lo cual le indicamos la permisología y usuario correspondiente.</p> <pre><code> chown -R www-data:root (ruta-absoluta-de-instalacion)
 chmod 755 (ruta-absoluta-de-instalacion)/storage
</code></pre> <h2 id=base-de-datos>Base de datos</h2> <p>El Sistema Administrativo KAVAC puede ser ejecutado con diferentes gestores de Base de Datos tales como PostgreSQL, MySQL, SQLite, entre otros, sin embargo se recomienda el uso del gestor de Base de Datos PostgreSQL por su capacidad en la gestión de información.</p> <p>Debe crear una base de datos en el gestor de su preferencia y configurarlo en el archivo .env con los datos de acceso. Ejemplo:</p> <pre><code> DB_CONNECTION=pgsql
 DB_HOST=localhost
 DB_PORT=5432
 DB_DATABASE=kavac
 DB_USERNAME=kavac
 DB_PASSWORD=kavac
</code></pre> <p>Una vez configurado el gestor de base de datos, se debe ejecutar el siguiente comando: </p> <pre><code> php artisan migrate
</code></pre> <p>Lo anterior creará la estructura de tablas de la base de datos necesaria para comenzar a gestionar la información. </p> <h2 id=procesamiento-de-colas>Procesamiento de colas</h2> <p>El sistema cuenta con procedimientos que permite establecer colas de trabajo para peticiones y registros con grandes cantidades de información, por tal motivo es necesario realizar una configuración previa antes de iniciar la aplicación.</p> <p>Dentro del archivo config/queue.php se encuentra las distintas variables a configurar para el uso de colas, por lo que se deben configurar el driver a usar para la gestión de las colas y posteriormente configurar los datos necesarios del servidor seleccionado.</p> <p>Lo primero es configurar dentro del archivo de entorno (.env) la variable <strong>QUEUE_CONNECTION</strong> para el uso del driver a implementar en la gestión de colas, por defecto está configurado para hacer uso del driver mediante base de datos de la siguiente manera:</p> <pre><code>QUEUE_CONNECTION=database
</code></pre> <p>Si se desea configurar otro driver para la gestión de colas se puede obtener información en la documentación oficial del framework <a href=https://docs.laravel.com>Laravel</a>.</p> <p>Una vez configurado el servidor de colas es necesario realizar los procedimientos necesarios para que los <strong>workers</strong> que procesan las colas de trabajo estén activos en todo momento, para esto es recomendable configurar a supervisorctl de la siguiente forma:</p> <ul> <li>Crear un archivo llamado <strong>kavac-worker.conf</strong> en la ruta <strong>/etc/supervisor/conf.d/</strong> con el siguiente contenido:<pre><code>[program:laravel-worker]
process_name=%(program_name)s_%(process_num)02d
command=/usr/bin/php &lt;ruta-de-la-aplicacion-kavac&gt;/artisan queue:work sqs --sleep=3 --tries=3
autostart=true
autorestart=true
user=&lt;usuario-del-sistema&gt;
numprocs=1
redirect_stderr=true
stdout_logfile=&lt;ruta-de-la-aplicacion-kavac&gt;/storage/logs/worker.log
stopwaitsecs=3600
</code></pre> </li> </ul> <div class="admonition note"> <ul> <li><code>/user/bin/php</code> es la ruta en donde se encuentra el comando php.</li> <li><code>&lt;ruta-de-la-aplicacion-kavac&gt;</code> es la ruta en donde se encuentra instalada la aplicación.</li> <li><code>&lt;usuario-del-sistema&gt;</code> es el usuario del sistema operativo en donde se encuentra la aplicación, el cual tendrá los permisos necesarios para ejecutar los distintos procesos.</li> </ul> </div> <ul> <li>Actualizar y ejecutar supervisorctl de la siguiente forma:<pre><code>sudo supervisorctl reread

sudo supervisorctl update

sudo supervisorctl start kavac-worker:*
</code></pre> </li> </ul> <h2 id=websockets>Websockets</h2> <p>La aplicación viene con un sistema de notificaciones en tiempo real con websockets por lo que es necesario iniciar y mantener el servidor que atiende y despacha estas peticiones, además de establecer algunos valores en el archivo <strong>.env</strong> de la siguiente forma:</p> <pre><code>PUSHER_APP_ID=&lt;API_ID&gt;
PUSHER_APP_KEY=&lt;API_KEY&gt;
PUSHER_APP_SECRET=&lt;API_SECRET&gt;
PUSHER_APP_CLUSTER=mt1
PUSHER_APP_TLS=false

WEBSOCKETS_HOST=&lt;WEBSOCKET_IP&gt;
WEBSOCKETS_PORT=&lt;WEBSOCKET_PORT&gt;
WEBSOCKETS_SSL_LOCAL_CERT=null
WEBSOCKETS_SSL_LOCAL_PK=null
WEBSOCKETS_SSL_PASSPHRASE=null

MIX_PUSHER_APP_KEY="${PUSHER_APP_KEY}"
MIX_PUSHER_APP_CLUSTER="${PUSHER_APP_CLUSTER}"
MIX_WEBSOCKETS_HOST="${WEBSOCKETS_HOST}"
MIX_WEBSOCKETS_PORT="${WEBSOCKETS_PORT}"
MIX_PUSHER_APP_TLS="${PUSHER_APP_TLS}"
</code></pre> <p>Luego de realizada la configuración en el archivo de entorno <strong>.env</strong> se requiere tener instalado en el servidor de aplicaciones una aplicación que monitoree y ejecute este servicio para lo cual se utiliza la aplicación <strong>supervisor</strong>.</p> <p>Una vez instalado <strong>supervisor</strong>, se requiere agregar y configurar un nuevo proceso que permita mantener la ejecución de los websockets de la aplicación, para lo cual se debe crear un nuevo archivo con el nombre <strong>websockets.conf</strong> dentro del directorio /etc/supervisor/conf.d (en Debian/Ubuntu) ó /etc/supervisord.d (en RedHat/CentOS).</p> <p>El archivo creado deberá contener la siguiente información:</p> <pre><code>[program:websockets]
command=/usr/bin/php &lt;ruta-de-la-aplicacion-kavac&gt;/artisan websockets:serve
numprocs=1
autostart=true
autorestart=true
user=&lt;usuario-del-sistema&gt;
</code></pre> <div class="admonition note"> <ul> <li><code>/user/bin/php</code> es la ruta en donde se encuentra el comando php.</li> <li><code>&lt;ruta-de-la-aplicacion-kavac&gt;</code> es la ruta en donde se encuentra instalada la aplicación.</li> <li><code>&lt;usuario-del-sistema&gt;</code> es el usuario del sistema operativo en donde se encuentra la aplicación, el cual tendrá los permisos necesarios para ejecutar los distintos procesos.</li> </ul> </div> <p>Con la configuración anteriormente descrita, se debe reiniciar el <strong>supervisor</strong> para que tome en cuenta la nueva configuración, para lo cual se ejecutan los siguientes comandos:</p> <pre><code>supervisorctl update

supervisorctl start websockets
</code></pre> <p>Para verificar que la configuración es correcta y el servicio se está ejecutando, se puede indicar el siguiente comando:</p> <pre><code>supervisorctl status
</code></pre> <h2 id=registros-iniciales>Registros iniciales</h2> <p>KAVAC, cuenta con información inicial requerida para la gestión de la aplicación, para lo cual se debe ejecutar el comando:</p> <pre><code> php artisan db:seed
</code></pre> <p>El anterior comando ejecutará las acciones necesarias para ingresar al sistema los datos inicialmente requeridos por la aplicación base como son: usuario, roles, permisos, localidades, estados civiles, profesiones, sectores de instituciones y tipos de instituciones.</p> <p>La aplicación cuenta con una cantidad de módulos independientes que permiten expandir sus funcionalidades, cada uno de estos módulos cuentan con sus registros iniciales por lo que es necesario ejecutar un comando adicional que permita registrar información de cada módulo instalado y habilitado en el sistema, para ello se ejecuta el siguiente comando:</p> <pre><code> php artisan module:seed
</code></pre> <p>Esto revisará que módulos del sistema están habilitados y procederá a registrar la información requerida, inicialmente, por cada uno de ellos.</p> <p>Una vez que hayan sido registrado los datos iniciales del sistema, se puede autenticar en el mismo con los siguientes datos de acceso como administrador (es recomendable modificar la contraseña en el primer acceso al sistema):</p> <pre><code> Usuario: admin
 Clave: 123456
</code></pre> <p>El primer paso, para el correcto funcionamiento del sistema, es registrar información básica de la institución que llevará a cabo la gestión de información dentro de la aplicación, para ello se debe ingresar al menú:</p> <pre><code> Configuración &gt; General
</code></pre> <p>En el panel "CONFIGURAR INSTITUCIÓN" se deben indicar los datos de la Institución, una vez configurada la institución se mostrarán todas las opciones de los módulos disponibles en el sistema.</p> <h2 id=probando-la-aplicacion>Probando la aplicación</h2> <p>Para identificar si la aplicación se encuentra correctamente instalada, puedes ejecutar el comando de artisan que te permite levantar un servidor en entornos de desarrollo de la siguiente forma:</p> <pre><code> php artisan serve
</code></pre> <p>Este comando levanta un servidor en la dirección ip 127.0.0.1 o localhost y en el puerto 8000, para verificarlo puedes acceder a el enlace (127.0.0.1:8000)</p> <p>Puedes, de igual forma asignarle una dirección IP o dominio a este comando y un puerto en donde atenderá las peticiones para lo cual se puede agregar las opciones --host y/o --port, un ejemplo de su uso sería:</p> <pre><code> php artisan serve --port 192.168.1.1 --port 9000
</code></pre> <h2 id=comandos-basicos-laravel-modules>Comandos básicos laravel-modules</h2> <p>Ejecutar las migraciones laravel-modules:</p> <pre><code> php artisan module:migrate
</code></pre> <p>Crea un nuevo modelo para el módulo especificado junto con su migración:</p> <pre><code> php artisan module:make-model -m ModuleNameModelName ModuleName
</code></pre> <p>Genera nuevo controlador restful para el módulo especificado:</p> <pre><code> php artisan module:make-controller ModuleNameModelName ModuleName
</code></pre> <p>Genera nuevo seeder para el módulo especificado (nombre del modelo en plural):</p> <pre><code> php artisan module:make-seed ModuleNameModelName ModuleName
</code></pre> <h2 id=laravel-er-diagram-generator>Laravel ER Diagram Generator</h2> <p>Este paquete permite generar diagramas de entidad relación inspeccionando las relaciones definidas en sus archivos de modelo. Por defecto busca los modelos en la carpeta app. Para agregar los modelos que se encuentran en cada módulo hay que hacer lo siguiente:</p> <pre><code>// Editar en el archivo
vendor/beyondcode/laravel-er-diagram-generator/config/config.php

// Esta sección en la linea 9
'directories' =&gt; [
    base_path('app'),
// Carpeta agregada para el módulo Payroll
    base_path('modules/Payroll/Models'),
],
</code></pre> <p>En ese ejemplo genera el diagrama del sistema base y del módulo Talento Humano.</p> <p>Comando para generar el diagrama:</p> <pre><code>php artisan generate:erd kavac.svg --format=svg
</code></pre> </article> </div> </div> </main> <footer class=md-footer> <div class=md-footer-nav> <nav class="md-footer-nav__inner md-grid" aria-label=Pie> <a href=../information/ title="Información General" class="md-footer-nav__link md-footer-nav__link--prev" rel=prev> <div class="md-footer-nav__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </div> <div class=md-footer-nav__title> <div class=md-ellipsis> <span class=md-footer-nav__direction> Anterior </span> Información General </div> </div> </a> <a href=../setting/setting/ title=Configuración class="md-footer-nav__link md-footer-nav__link--next" rel=next> <div class=md-footer-nav__title> <div class=md-ellipsis> <span class=md-footer-nav__direction> Siguiente </span> Configuración </div> </div> <div class="md-footer-nav__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg> </div> </a> </nav> </div> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-footer-copyright> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> </div> </div> </footer> </div> <script src=../assets/javascripts/vendor.d710d30a.min.js></script> <script src=../assets/javascripts/bundle.b39636ac.min.js></script><script id=__lang type=application/json>{"clipboard.copy": "Copiar al portapapeles", "clipboard.copied": "Copiado al portapapeles", "search.config.lang": "es", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.result.placeholder": "Teclee para comenzar b\u00fasqueda", "search.result.none": "No se encontraron documentos", "search.result.one": "1 documento encontrado", "search.result.other": "# documentos encontrados"}</script> <script>
        app = initialize({
          base: "..",
          features: ["navigation.tabs"],
          search: Object.assign({
            worker: "../assets/javascripts/worker/search.a68abb33.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script> </body> </html>